const mainPageItems=document.querySelector(".swiper-wrapper"),catalogPageItems=document.querySelector(".products-catalog"),items=document.querySelector(".item-product"),checkbox=document.querySelector("#filters");function addEvent(e,t,r){return e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,(function(){r.call(e)})),!1}const result=[{id:1,url:"#",title:"Flower1",text:"sometext",labels:[{type:"HOTflower"}],image:".//img/catalog/flower01.jpg",price:"2000",priceOld:"",type:"popular",light:"яркие",color:"оранжевый"},{id:2,url:"#",title:"Flower2",text:"sometext",labels:[{type:"HOTflower"}],image:".//img/catalog/flower02.jpg",price:"3000",priceOld:"",type:"popular",light:"нежные",color:"белый"},{id:3,url:"#",title:"Flower3",text:"sometext",labels:[{type:"HOTflower"}],image:".//img/catalog/flower03.jpg",price:"4000",priceOld:"",type:"popular",light:"нежные",color:"синий"},{id:4,url:"#",title:"Flower4",text:"sometext",labels:[{type:"HOTflower"}],image:".//img/catalog/flower04.jpg",price:"2000",priceOld:"",type:"popular",light:"нежные",color:"белый"},{id:5,url:"#",title:"Flower5",text:"sometext",labels:[{type:"HOTflower"}],image:".//img/catalog/flower05.jpg",price:"4000",priceOld:"",type:"popular",light:"яркие",color:"розовый"},{id:6,url:"#",title:"Flower6",text:"sometext",labels:[{type:"HOTflower"}],image:".//img/catalog/flower06.jpg",price:"3000",priceOld:"",type:"popular",light:"нежные",color:"розовый"},{id:7,url:"#",title:"Flower7",text:"sometext",labels:[{type:"HOTflower"}],image:".//img/catalog/flower07.jpg",price:"5000",priceOld:"",light:"нежные",color:"белый"},{id:8,url:"#",title:"Flower8",text:"sometext",labels:[{type:"HOTflower"}],image:".//img/catalog/flower08.jpg",price:"3000",priceOld:"",light:"нежные",color:"розовый"},{id:9,url:"#",title:"Flower9",text:"sometext",labels:[{type:"HOTflower"}],image:".//img/catalog/flower09.jpg",price:"2000",light:"нежные",color:"желтый"},{id:10,url:"#",title:"Flower10",text:"sometext",labels:[{type:"HOTflower"}],image:".//img/catalog/flower10.jpg",price:"4000",priceOld:"",light:"яркие",color:"желтый"},{id:11,url:"#",title:"Flower11",text:"sometext",labels:[{type:"HOTflower"}],image:".//img/catalog/flower11.jpg",price:"2000",priceOld:"",light:"яркие",color:"синий"}];function getProducts(){mainPageItems?loadProducts(result.filter((e=>"popular"==e.type))):(loadProducts(result),filter(result))}function filter(e){if(catalogPageItems){const t=document.querySelector("#light").getElementsByTagName("input"),r=document.querySelector("#color").getElementsByTagName("input");document.querySelector("#restoreFilter").onclick=function(){for(let e=0;e<t.length;e++)t[e].checked=!1;for(let e=0;e<r.length;e++)r[e].checked=!1;getProducts()},checkbox.addEventListener("input",(function(){const t=[...checkbox.querySelectorAll("#light input:checked")].map((e=>e.value)),r=[...checkbox.querySelectorAll("#color input:checked")].map((e=>e.value));loadProducts(e.filter((e=>(!t.length||t.includes(e.light))&&(!r.length||r.includes(e.color)))))}))}}function deleteItems(){for(;catalogPageItems.firstChild;)catalogPageItems.removeChild(catalogPageItems.lastChild)}function loadProducts(e){let t;catalogPageItems&&deleteItems(),e.forEach((e=>{const r=e.id,l=e.url,i=e.image,o=e.title,a=e.price,c=e.labels;mainPageItems?t=`<div data-id="${r}" class="swiper-slide">`:catalogPageItems&&(t=`<div data-id="${r}" class="item-product">`);let n="";if(c){let e='<div class="item-product__labels">',t="</div>",r="";c.forEach((e=>{r+=`<div class="item-product__label item-product__label_${e.type}">${e.value}</div>`})),n+=e,n+=r,n+=t}let s="";s='<div class="item-product__prices">',s+="</div>";let u="";u+=t,u+=` <a href="${l}" class="item-product__image">\n\t\t<img id="image" src="${i}" alt="${o}"></a>\n\t\t`,u+=`\n\t\t<p class="item-product__title">${o}</p>\n\t\t<p class="item-product__price">${a}</p>\n\t\t`,u+='<div class="item-product__prices"></div>',u+='\n\t\t\t<button class="button-cart addToCart">В корзину</button>\n\t\t',u+="</div>",mainPageItems?mainPageItems.insertAdjacentHTML("beforeend",u):catalogPageItems&&catalogPageItems.insertAdjacentHTML("beforeend",u)})),(catalogPageItems||mainPageItems)&&addToCart()}const cart=document.querySelector(".cart__items");function addToCart(){if(catalogPageItems)var e=document.querySelectorAll(".item-product");else if(mainPageItems)e=document.querySelectorAll(".swiper-slide");for(let t=0;t<e.length;t++)addEvent(e[t].querySelector(".addToCart"),"click",(function(){let r=getCartData()||{},l=e[t].getAttribute("data-id"),i=e[t].querySelector(".item-product__title").innerHTML,o=e[t].querySelector(".item-product__price").innerHTML,a=e[t].querySelector("#image").getAttribute("src");a=`<img class="cart__image" src="${a}">`,r.hasOwnProperty(l)?r[l][4]+=1:r[l]=[l,a,i,o,1],setCartData(r),openCart()}))}function openCart(){let e=getCartData(),t="";if(null!==e){for(var r in e){let l=e[r][0],i=e[r][1],o=e[r][2],a=e[r][3],c=e[r][4];t+='<div class="cart__item item">',t+=`<div class="item__id">${l}</div>`,t+=`<div class="item__img">${i}</div>`,t+=`<div class="item__title">${o}</div>`,t+=`<div class="item__price">${a} ₽</div>`,t+='<div class="upDownContainer">',t+=c<=1?`<input item-id =  ${l}    id='down' class= 'down-button' type='button' value='-' data-changer='2' disabled>`:`<input item-id =  ${l}    id='down' class= 'down-button' type='button' value='-' data-changer='2'>`,t+=`<div class="item__count">${c}</div>`,t+=`<input item-id =  ${l}    class='up-button' id='up' type='button' value='+' data-changer='1'>`,t+="</div>",t+=`<input item-id = ${l} type="button" value='удалить' class="delete-button">`,t+="</div>",t+='<hr class= "cart__hr">'}cart.innerHTML=t}else cart.innerHTML="В корзине пусто!";itemCount()}function itemCount(){let e=[],t=document.querySelector("#totalItemsCount"),r=document.querySelector("#totalItemsCountMobile");const l=document.querySelector("#spanContainer"),i=document.querySelector("#spanContainerMobile");window.screen.width;[...document.querySelectorAll(".item__count")].map((t=>e.push(t.textContent)));const o=(e,t)=>+e+ +t;0!==e.length?(l.classList.add("spanContainer-green"),i.classList.add("spanContainer-green"),r.innerHTML=e.reduce(o),i.classList.add("spanContainer-green"),t.innerHTML=e.reduce(o)):(l.classList.remove("spanContainer-green"),t.innerHTML="",i.classList.remove("spanContainer-green"),r.innerHTML="")}function setCartData(e){localStorage.setItem("cart",JSON.stringify(e))}function getCartData(){return JSON.parse(localStorage.getItem("cart"))}function cartOpenAndClose(){const e=document.querySelector("#buttonOpenCart"),t=document.querySelector("#buttonOpenCartMobile"),r=document.querySelector("#buttonCloseCart"),l=document.querySelector(".cart"),i=document.querySelector(".wrapper");e.onclick=function(){l.classList.add("_opened"),i.classList.add("_matteEffect"),document.body.classList.add("_lock")},t.onclick=function(){l.classList.add("_opened"),i.classList.add("_matteEffect"),document.body.classList.add("_lock")},r.onclick=function(){l.classList.remove("_opened"),i.classList.remove("_matteEffect"),document.body.classList.remove("_lock")}}function testWebP(e){var t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}addEvent(cart,"click",(function(e){if("up-button"===e.target.className){let t=e.target.getAttribute("item-id"),r=getCartData();r[t][4]+=1,setCartData(r),openCart()}else if("down-button"===e.target.className){let t=e.target.getAttribute("item-id"),r=getCartData();r[t][4]-=1,setCartData(r),openCart()}else if("delete-button"===e.target.className){let t=e.target.getAttribute("item-id"),r=getCartData();delete r[t],setCartData(r),openCart()}})),testWebP((function(e){!0===e?document.querySelector("html").classList.add("_webp"):document.querySelector("html").classList.add("_no-webp")})),window.onload=function(){getProducts(),openCart(),itemCount(),cartOpenAndClose(),window.outerWidth>=windowTrigger&&mainPageItems&&(swiperInit(),setTimeout((function(){swiper.update(swiper)}),500))};let swiper=null,windowTrigger=768,swiperContainer=document.querySelector(".swiper-container"),url=window.location.href,clean_url=url.replace(/(\\|\/)/g,"");if(mainPageItems){function swiperInit(){swiper||(swiper=new Swiper(".swiper-container",{slidesPerView:3,loop:!0,direction:"horizontal",spaceBetween:50,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},scrollbar:{el:".swiper-scrollbar"}}))}function swiperDestroy(){swiper&&(swiper.destroy(),swiper=null)}onresize=function(){window.innerWidth>=windowTrigger?swiperInit():swiperDestroy()}}const filterBlur=document.querySelector("#filterGreen"),filterBluePurple=document.querySelector("#filterPurple"),errorPage=document.querySelector(".error-page"),deliveryPage=document.querySelector(".delivery"),aboutPage=document.querySelector(".about"),faqPage=document.querySelector(".faq"),homePage=document.querySelector(".home"),contactsPage=document.querySelector(".contacts");(errorPage||faqPage)&&(filterBlur.classList.remove("filterBlurGreen"),filterBlur.classList.add("filterBlurBlue"),filterBluePurple.classList.remove("filterBlurPurple"),filterBluePurple.classList.add("filterBlurBLue")),deliveryPage&&(filterBlur.classList.remove("filterBlurGreen"),filterBlur.classList.add("filterBlurBrown"),filterBluePurple.classList.remove("filterBlurPurple"),filterBluePurple.classList.add("filterBlurBrown")),aboutPage&&(filterBlur.classList.remove("filterBlurGreen"),filterBlur.classList.add("filterBlurYellow"),filterBluePurple.classList.remove("filterBlurPurple"),filterBluePurple.classList.add("filterBlurYellow")),homePage&&(filterBlur.classList.remove("filterBlurBlue"),filterBlur.classList.add("filterBlurGreen"),filterBluePurple.classList.remove("filterBlurYellow"),filterBluePurple.classList.add("filterBlurPurple")),contactsPage&&(filterBlur.classList.remove("filterBlurGreen"),filterBlur.classList.add("filterBlurRed"),filterBluePurple.classList.remove("filterBlurPurple"),filterBluePurple.classList.add("filterBlurRed"));const screenWidth=window.screen.width,header=document.querySelector(".header"),heading=document.querySelector(".main__heading"),headingMobile=document.querySelector(".heading__mobile");!homePage&&screenWidth<=767.98&&(headingMobile.style.display="block"),screenWidth<=767.98&&window.addEventListener("scroll",(function(){window.pageYOffset>=90&&(headingMobile.style.display="block"),window.pageYOffset<=90&&homePage&&(headingMobile.style.display="none")}));const burger=document.querySelector(".burger"),nav=document.querySelector(".header__list"),burgerContainer=document.querySelector(".burgerContainer"),body=document.querySelector("main");burger.onclick=function(){burger.classList.toggle("_active"),nav.classList.toggle("_active"),document.body.classList.toggle("_lock"),burgerContainer.classList.toggle("burgerContainer--right"),body.classList.toggle("_matteEffect")};