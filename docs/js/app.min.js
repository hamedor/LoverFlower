const mainPageItems=document.querySelector(".swiper-wrapper"),catalogPageItems=document.querySelector(".products-catalog"),items=document.querySelector(".item-product"),checkbox=document.querySelector("#filters");if(catalogPageItems||mainPageItems)function addEvent(e,t,r){return e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,(function(){r.call(e)})),!1}async function getProducts(){let e=await fetch("json/products.json",{method:"GET"});if(e.ok){let t=await e.json();filter(t),loadProducts(t)}}if(catalogPageItems||mainPageItems){function filter(e){catalogPageItems&&checkbox.addEventListener("input",(function(){const t=[...checkbox.querySelectorAll("#light input:checked")].map((e=>e.value)),r=[...checkbox.querySelectorAll("#color input:checked")].map((e=>e.value));loadProducts(e.filter((e=>(!t.length||t.includes(e.light))&&(!r.length||r.includes(e.color)))))}))}function deleteItems(){for(;catalogPageItems.firstChild;)catalogPageItems.removeChild(catalogPageItems.lastChild)}function loadProducts(e){let t;catalogPageItems&&deleteItems(),e.forEach((e=>{const r=e.id,a=e.url,i=e.image,o=e.title,l=e.price,n=e.priceOld,c=e.labels;mainPageItems?t=`<div data-id="${r}" class="swiper-slide">`:catalogPageItems&&(t=`<div data-id="${r}" class="item-product">`);let s="";if(c){let e='<div class="item-product__labels">',t="</div>",r="";c.forEach((e=>{r+=`<div class="item-product__label item-product__label_${e.type}">${e.value}</div>`})),s+=e,s+=r,s+=t}let d="";d='<div class="item-product__prices">',d+=`<div class="item-product__price">Rp ${l}</div>`,n&&(d+=`<del class="item-product__price item-product__oldPrice">Rp ${n}</del>`),d+="</div>";let u="";u+=t,u+=` <a href="${a}" class="item-product__image">\n\t\t<img id="image" src="${i}" alt="${o}"></a>\n\t\t`,u+=`\n\t\t<p class="item-product__title">${o}</p>\n\t\t<p class="item-product__price">${l}</p>\n\t\t`,u+=d,u+='\n\t\t\n\t\t\t<button class="button-cart addToCart">В корзину</button>\n\t\t\n\t\t',u+="</div>",mainPageItems?mainPageItems.insertAdjacentHTML("beforeend",u):catalogPageItems&&catalogPageItems.insertAdjacentHTML("beforeend",u)})),addToCart()}const e=document.querySelector(".cart__items");function openCart(){let t=getCartData(),r="";if(null!==t){for(var a in t){let e=t[a][0],i=t[a][1],o=t[a][2],l=t[a][3],n=t[a][4];r+='<div class="cart__item item">',r+=`<div class="item__id">${e}</div>`,r+=`<div class="item__img">${i}</div>`,r+=`<div class="item__title">${o}</div>`,r+=`<div class="item__price">${l} ₽</div>`,r+='<div class="upDownContainer">',r+=n<=1?`<input item-id =  ${e}    id='down' class= 'down-button' type='button' value='-' data-changer='2' disabled>`:`<input item-id =  ${e}    id='down' class= 'down-button' type='button' value='-' data-changer='2'>`,r+=`<div class="item__count">${n}</div>`,r+=`<input item-id =  ${e}    class='up-button' id='up' type='button' value='+' data-changer='1'>`,r+="</div>",r+=`<input item-id = ${e} type="button" value='удалить' class="delete-button">`,r+="</div>",r+='<hr class= "cart__hr">'}e.innerHTML=r}else e.innerHTML="В корзине пусто!"}function setCartData(e){localStorage.setItem("cart",JSON.stringify(e))}function getCartData(){return JSON.parse(localStorage.getItem("cart"))}addToCart=function(){if(catalogPageItems)var e=document.querySelectorAll(".item-product");else if(mainPageItems)e=document.querySelectorAll(".swiper-slide");for(let t=0;t<e.length;t++)addEvent(e[t].querySelector(".addToCart"),"click",(function(){let r=getCartData()||{},a=e[t].getAttribute("data-id"),i=e[t].querySelector(".item-product__title").innerHTML,o=e[t].querySelector(".item-product__price").innerHTML,l=e[t].querySelector("#image").getAttribute("src");l=`<img class="cart__image" src="${l}">`,r.hasOwnProperty(a)?r[a][4]+=1:r[a]=[a,l,i,o,1],setCartData(r),openCart()}))},addEvent(e,"click",(function(e){if("up-button"===e.target.className){let t=e.target.getAttribute("item-id"),r=getCartData();r[t][4]+=1,setCartData(r),openCart()}else if("down-button"===e.target.className){let t=e.target.getAttribute("item-id"),r=getCartData();r[t][4]-=1,setCartData(r),openCart()}else if("delete-button"===e.target.className){let t=e.target.getAttribute("item-id"),r=getCartData();delete r[t],setCartData(r),openCart()}}));const t=document.querySelector("#buttonOpenCart"),r=document.querySelector("#buttonCloseCart"),a=document.querySelector(".cart"),i=document.querySelector(".wrapper");t.onclick=function(){a.classList.add("_opened"),i.classList.add("_matteEffect"),openCart()},r.onclick=function(){a.classList.remove("_opened"),i.classList.remove("_matteEffect")}}function testWebP(e){var t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}testWebP((function(e){!0===e?document.querySelector("html").classList.add("_webp"):document.querySelector("html").classList.add("_no-webp")}));const burger=document.querySelector(".burger"),nav=document.querySelector(".header__list"),burgerContainer=document.querySelector(".burgerContainer");burger.onclick=function(){burger.classList.toggle("_active"),nav.classList.toggle("_active"),document.body.classList.toggle("_lock"),burgerContainer.classList.toggle("burgerContainer--right")},window.onload=function(){(catalogPageItems||mainPageItems)&&getProducts(),window.outerWidth>=windowTrigger&&mainPageItems&&(swiperInit(),setTimeout((function(){swiper.update(swiper)}),500))};let swiper=null,windowTrigger=768,swiperContainer=document.querySelector(".swiper-container"),url=window.location.href,clean_url=url.replace(/(\\|\/)/g,"");if(mainPageItems){function swiperInit(){swiper||(swiper=new Swiper(".swiper-container",{slidesPerView:3,loop:!0,direction:"horizontal",spaceBetween:50,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},scrollbar:{el:".swiper-scrollbar"}}))}function swiperDestroy(){swiper&&(swiper.destroy(),swiper=null)}onresize=function(){window.innerWidth>=windowTrigger?swiperInit():swiperDestroy()}}const filterBlur=document.querySelector("#filterGreen"),filterBluePurple=document.querySelector("#filterPurple"),errorPage=document.querySelector(".error-page");errorPage&&(filterBlur.classList.remove("filterBlurGreen"),filterBlur.classList.add("filterBlurBlue"),filterBluePurple.classList.remove("filterBlurPurple"),filterBluePurple.classList.add("filterBlurBLue"));